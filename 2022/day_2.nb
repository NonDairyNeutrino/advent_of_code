(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11822,        317]
NotebookOptionsPosition[     11002,        284]
NotebookOutlinePosition[     11404,        300]
CellTagsIndexPosition[     11361,        297]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Advent of Code Day 2", "Title",
 CellChangeTimes->{{3.878958794717474*^9, 
  3.8789588038578444`*^9}},ExpressionUUID->"733f2abd-1123-482c-ad87-\
c63adcaf79f6"],

Cell[CellGroupData[{

Cell["Part 1", "Section",
 CellChangeTimes->{{3.878958808959696*^9, 
  3.878958809704191*^9}},ExpressionUUID->"1768dc81-48b8-4acb-ba34-\
a42d0f25c84d"],

Cell[CellGroupData[{

Cell["Input parsing", "Subsection",
 CellChangeTimes->{{3.878958814280199*^9, 
  3.8789588185206385`*^9}},ExpressionUUID->"5696f275-2067-4cfb-9e7d-\
d12c1d077fa6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "@", 
   RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"input", "=", 
   RowBox[{"StringSplit", "@", 
    RowBox[{"StringSplit", "[", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Directory", "[", "]"}], ",", "\"\<day_2_input.txt\>\""}], 
         "}"}], "]"}], "]"}], ",", "\"\<\\n\>\""}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878958831041391*^9, 3.8789589478749633`*^9}},
 ExpressionUUID -> "80f38ad0-c3cb-43e6-a467-f90d3f6a8bc6"]
}, Closed]],

Cell[CellGroupData[{

Cell["Solution", "Subsection",
 CellChangeTimes->{{3.8789589883058696`*^9, 
  3.8789589908767314`*^9}},ExpressionUUID->"e1f32ffa-3d86-48ee-9e0b-\
d939238298ed"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{
  "\"\<verterxWeight*\>\"", ",", "\"\<Global`*Edges\>\"", ",", 
   "\"\<beatsGraph\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vertexWeightMatrix", "=", 
   RowBox[{"Transpose", "@", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", "2", ",", "1"}], "}"}], ",", "3"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vertexWeightList", "=", 
    RowBox[{"Diagonal", "@", "vertexWeightMatrix"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stateWeight", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<win\>\"", "->", "6"}], ",", 
     RowBox[{"\"\<draw\>\"", "->", "3"}], ",", 
     RowBox[{"\"\<lose\>\"", "->", "0"}]}], "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"winEdges", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<C\>\"", "\[DirectedEdge]", "\"\<B\>\""}], ",", 
     RowBox[{"\"\<B\>\"", "\[DirectedEdge]", "\"\<A\>\""}], ",", 
     RowBox[{"\"\<A\>\"", "\[DirectedEdge]", "\"\<C\>\""}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"weightedWinEdges", "=", 
   RowBox[{
    RowBox[{"winEdges", "->", 
     RowBox[{"stateWeight", "@", "\"\<win\>\""}]}], "//", "Thread"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"selfEdges", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<C\>\"", "\[DirectedEdge]", "\"\<C\>\""}], ",", 
     RowBox[{"\"\<B\>\"", "\[DirectedEdge]", "\"\<B\>\""}], ",", 
     RowBox[{"\"\<A\>\"", "\[DirectedEdge]", "\"\<A\>\""}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"weightedSelfEdges", "=", 
   RowBox[{
    RowBox[{"selfEdges", "->", 
     RowBox[{"stateWeight", "@", "\"\<draw\>\""}]}], "//", "Thread"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"loseEdges", "=", 
   RowBox[{"Reverse", "/@", "winEdges"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"weightedLoseEdges", "=", 
   RowBox[{
    RowBox[{"loseEdges", "->", 
     RowBox[{"stateWeight", "@", "\"\<lose\>\""}]}], "//", "Thread"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"edgeList", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"winEdges", ",", "selfEdges", ",", "loseEdges"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"edgeWeightList", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
     "weightedWinEdges", ",", "weightedSelfEdges", ",", "weightedLoseEdges"}],
      "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"rpsGraph", "=", 
  RowBox[{"Graph", "[", "\[IndentingNewLine]", 
   RowBox[{"edgeList", ",", "\[IndentingNewLine]", 
    RowBox[{"VertexWeight", "->", "vertexWeightList"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"EdgeWeight", "->", "edgeWeightList"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"EdgeLabels", "->", "\"\<EdgeWeight\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"VertexLabels", "->", "\"\<VertexWeight\>\""}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rpsMat", "=", 
   RowBox[{"vertexWeightMatrix", "+", 
    RowBox[{"Normal", "@", 
     RowBox[{"WeightedAdjacencyMatrix", "@", "rpsGraph"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "@", "rpsMat"}]}], "Input",
 CellChangeTimes->{{3.8789952440095615`*^9, 3.8789953627201605`*^9}, {
   3.8789957116166325`*^9, 3.878995735973884*^9}, {3.8789957894252067`*^9, 
   3.878995823092353*^9}, {3.8789959279443874`*^9, 3.878995944621455*^9}, {
   3.878996011005057*^9, 3.8789960525645595`*^9}, {3.8789962684851365`*^9, 
   3.878996300257913*^9}, {3.878996345306262*^9, 3.8789963559770107`*^9}, {
   3.8789963913154173`*^9, 3.878996452047265*^9}, {3.8789964880932584`*^9, 
   3.878996554157519*^9}, {3.8790013885548625`*^9, 3.879001396988866*^9}, {
   3.8790015068103476`*^9, 3.879001637724514*^9}, {3.879001812523795*^9, 
   3.8790018578466*^9}, {3.8790018900934153`*^9, 3.879001897184456*^9}, {
   3.8790020270685034`*^9, 3.8790020986588273`*^9}, {3.8790021627783155`*^9, 
   3.879002169497012*^9}, {3.8790023111044874`*^9, 3.879002324388256*^9}, {
   3.8790024792584066`*^9, 3.8790024831764865`*^9}, {3.87900252920387*^9, 
   3.8790025672889543`*^9}, {3.879002613823274*^9, 3.8790026693134346`*^9}, {
   3.8790133861295347`*^9, 3.879013437366351*^9}, {3.8790134810090094`*^9, 
   3.8790136098909564`*^9}, {3.879014131280535*^9, 3.879014185802387*^9}, {
   3.879014220220625*^9, 3.8790142434966497`*^9}, {3.879014284223777*^9, 
   3.8790145209206142`*^9}, {3.879014726126813*^9, 3.8790147265428753`*^9}, {
   3.879014811690345*^9, 3.8790148150407248`*^9}, {3.8790149272940702`*^9, 
   3.8790151496128798`*^9}, {3.8790152241429763`*^9, 3.879015348642459*^9}, {
   3.879015379270026*^9, 3.8790153837672205`*^9}, {3.879015430959159*^9, 
   3.8790158136861515`*^9}, {3.879015918088441*^9, 3.879015960908867*^9}, {
   3.8790159988874393`*^9, 3.8790162210607147`*^9}, {3.8790163533351307`*^9, 
   3.8790163596491423`*^9}, {3.879016580926247*^9, 3.879016688985256*^9}, {
   3.8790167579347925`*^9, 3.879016911634365*^9}, {3.8790169579596786`*^9, 
   3.8790170086282864`*^9}, {3.8790193148205523`*^9, 
   3.8790193316087017`*^9}, {3.8790195327783184`*^9, 3.879019565916029*^9}, {
   3.879019630238433*^9, 3.879019652856917*^9}, {3.879019723886569*^9, 
   3.8790197633867884`*^9}, {3.8790432387543716`*^9, 3.8790432764740057`*^9}, 
   3.87904393688761*^9, 3.8790440714504657`*^9, 3.879044531739494*^9, {
   3.8790448644714937`*^9, 3.8790448738257627`*^9}},
 ExpressionUUID -> "0dfc353b-e220-42c9-a3d6-ba641f096182"],

Cell[BoxData[{
 RowBox[{"Clear", "@", "vectorize"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vectorize", "=", 
   RowBox[{"AssociationThread", "[", 
    RowBox[{
     RowBox[{"VertexList", "@", "rpsGraph"}], "->", 
     RowBox[{"IdentityMatrix", "[", "3", "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.879000118164137*^9, 3.8790001678603616`*^9}, 
   3.879013788780117*^9, {3.8790207121967525`*^9, 3.8790207150229406`*^9}},
 ExpressionUUID -> "1777ebc4-3711-47b1-8d1f-a0adc4bcc11f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Inner", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"vectorize", "@", "#2"}], ".", "rpsMat", ".", 
       RowBox[{"vectorize", "@", "#1"}]}], "&"}], ",", "##"}], "]"}], "&"}], "@@", 
  RowBox[{"Transpose", "[", 
   RowBox[{"input", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<X\>\"", "\[Rule]", "\"\<A\>\""}], ",", 
      RowBox[{"\"\<Y\>\"", "\[Rule]", "\"\<B\>\""}], ",", 
      RowBox[{"\"\<Z\>\"", "\[Rule]", "\"\<C\>\""}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.87904554436558*^9, 3.8790455474872894`*^9}, {
  3.879046285445629*^9, 3.879046292472274*^9}, {3.879046384667962*^9, 
  3.8790463994113827`*^9}, {3.8790465053014603`*^9, 3.879046561753028*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Part 2", "Section",
 CellChangeTimes->{{3.8789937774920874`*^9, 
  3.878993778205188*^9}},ExpressionUUID->"93493e00-09ae-40e3-918c-\
1dbfcf0cdb32"],

Cell[BoxData[{
 RowBox[{"input", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"op_", ",", "\"\<X\>\""}], "}"}], ":>", 
     RowBox[{"{", 
      RowBox[{"op", ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<A\>\"", ",", "\"\<B\>\"", ",", "\"\<C\>\""}], "}"}], 
        ".", "losesMat", ".", 
        RowBox[{"vectorize", "@", "op"}]}]}], "}"}]}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"op_", ",", "\"\<Y\>\""}], "}"}], ":>", 
     RowBox[{"{", 
      RowBox[{"op", ",", "op"}], "}"}]}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"op_", ",", "\"\<Z\>\""}], "}"}], ":>", 
     RowBox[{"{", 
      RowBox[{"op", ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<A\>\"", ",", "\"\<B\>\"", ",", "\"\<C\>\""}], "}"}], 
        ".", "beatsMat", ".", 
        RowBox[{"vectorize", "@", "op"}]}]}], "}"}]}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"Total", "@", 
  RowBox[{"Extract", "[", 
   RowBox[{"pointMat", ",", 
    RowBox[{"%", "/.", "choiceToPoint"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8789955629157887`*^9, 3.8789956054062333`*^9}, {
   3.878995741376021*^9, 3.8789957600799236`*^9}, {3.8789965734808493`*^9, 
   3.878996608161121*^9}, {3.8789972569657946`*^9, 3.878997276453323*^9}, {
   3.8789973125933795`*^9, 3.8789974244561305`*^9}, {3.8789974579656563`*^9, 
   3.8789974630433207`*^9}, {3.87899946204358*^9, 3.8789995029754477`*^9}, {
   3.878999537451662*^9, 3.8789995386575837`*^9}, {3.8789995773537126`*^9, 
   3.8789995809364104`*^9}, {3.8789998896866198`*^9, 3.8789999112273397`*^9}, 
   3.879000112448348*^9, {3.8790001712010374`*^9, 3.879000226994875*^9}, {
   3.8790005706314573`*^9, 3.879000581008074*^9}, {3.8790007338017917`*^9, 
   3.879000766060335*^9}, {3.8790009525718145`*^9, 3.879000959523912*^9}, 
   3.87900121745173*^9},
 ExpressionUUID -> "97a48167-9ee5-4ffc-8f00-ad741f93ee3a"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1704, 1358},
WindowMargins->{{-7, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.1 for Microsoft Windows (64-bit) (March 23, 2015)",
StyleDefinitions->"Default.nb",
ExpressionUUID -> "50872f04-295f-42af-97bb-58e7703f803d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 165, 3, 90, "Title"],
Cell[CellGroupData[{
Cell[770, 29, 151, 3, 63, "Section"],
Cell[CellGroupData[{
Cell[946, 36, 163, 3, 43, "Subsection"],
Cell[1112, 41, 643, 17, 52, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[1792, 63, 160, 3, 35, "Subsection"],
Cell[1955, 68, 5636, 123, 472, "Input"],
Cell[7594, 193, 499, 10, 52, "Input"],
Cell[8096, 205, 756, 19, 31, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[8901, 230, 153, 3, 63, "Section"],
Cell[9057, 235, 1917, 45, 52, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

